{
  "name": "better-auth",
  "type": "auth",
  "priority": 10,
  "operations": [
    {
      "type": "create-file",
      "source": "lib/auth.ts",
      "destination": "lib/auth.ts",
      "condition": { "framework": ["nextjs", "express"] }
    },
    {
      "type": "create-file",
      "source": "lib/email-service.ts",
      "destination": "lib/email/email-service.ts",
      "condition": { "framework": ["nextjs", "express"] }
    },
    {
      "type": "create-file",
      "source": "lib/email-templates.ts",
      "destination": "lib/email/email-templates.ts",
      "condition": { "framework": ["nextjs", "express"] }
    },
    {
      "type": "create-file",
      "source": "api/auth/[...all]/route.ts",
      "destination": "app/api/auth/[...all]/route.ts",
      "condition": { "framework": "nextjs" }
    },
    {
      "type": "create-file",
      "source": "lib/auth-client.ts",
      "destination": "lib/auth-client.ts",
      "condition": { "framework": ["nextjs", "react"] }
    },
    {
      "type": "patch-file",
      "destination": "prisma/schema.prisma",
      "condition": { "database": "prisma" },
      "operations": [
        {
          "type": "add-to-bottom",
          "source": "prisma/schema.prisma"
        }
      ]
    },
    {
      "type": "patch-file",
      "destination": "src/server.ts",
      "condition": { "framework": "express" },
      "operations": [
        {
          "type": "add-import",
          "imports": ["import { initAuth } from \"../lib/auth\";"]
        },
        {
          "type": "add-code",
          "before": "const port = env.port;",
          "code": "await initAuth();"
        }
      ]
    },
    {
      "type": "patch-file",
      "destination": "src/app.ts",
      "condition": { "framework": "express" },
      "operations": [
        {
          "type": "add-import",
          "imports": ["import { auth } from \"../lib/auth\";",
          "import { toNodeHandler } from \"better-auth/node\";"]
        },
        {
          "type": "add-code",
          "after": "// routes",
          "code": "app.all(\"/api/auth/*splat\", toNodeHandler(auth));"
        }
      ]
    },
    {
      "type": "add-dependency",
      "condition": { "framework": ["nextjs", "express"] },
      "dependencies": {
        "nodemailer": "^7.0.12"
      },
      "devDependencies": {
        "@types/nodemailer": "^7.0.5"
      }
    },
    {
      "type": "add-env",
      "envVars": {
        "BETTER_AUTH_SECRET": "",
        "BETTER_AUTH_URL": "http://localhost:3000",
        "EMAIL_HOST": "smtp.gmail.com",
        "EMAIL_PORT": "587",
        "EMAIL_USER": "",
        "EMAIL_PASS": "",
        "EMAIL_FROM": "noreply@yourapp.com"
        }
      },
    {
      "type": "add-dependency",
      "dependencies": {
        "better-auth": "^1.4.12"
      }
    }
  ]
}